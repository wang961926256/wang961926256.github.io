<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>Java 读取excel文件 - wangqj-blog </title>
    
    <link rel='dns-prefetch' href='//s.w.org' />
    <meta charset="UTF-8" />
    <meta name="referrer" content="no-referrer">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel='stylesheet' id='travelify_style-css'  href="http://balaramadurai.github.io/css/style.min.css" type='text/css' media='all' />
    <link rel='stylesheet' id='google_font_ubuntu-css'  href="http://balaramadurai.github.io/css/style.min.css" type='text/css' media='all' />
    <link rel="shortcut icon" href="http://balaramadurai.github.io//favicon.ico" type="image/x-icon">
    
    <script type="text/javascript">
     window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/balaramadurai.github.io\/\/js\/wp-emoji-release.min.js"}};
     !function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
    </script>
    <style type="text/css">
     img.wp-smiley,
     img.emoji {
	 display: inline !important;
	 border: none !important;
	 box-shadow: none !important;
	 height: 1em !important;
	 width: 1em !important;
	 margin: 0 .07em !important;
	 vertical-align: -0.1em !important;
	 background: none !important;
	 padding: 0 !important;
     }
    </style>


    <style type="text/css">
     a { color: #57AD68; }
     #site-title a { color: ; }
     #site-title a:hover { color: ; }
     .wrapper { background: #F8F8F8; }
     .social-icons ul li a { color: #d0d0d0; list-style: none;}
     #main-nav a, #main-nav a:hover,  #main-nav a:focus, #main-nav ul li.current-menu-item a,#main-nav ul li.current_page_ancestor a,#main-nav ul li.current-menu-ancestor a,#main-nav ul li.current_page_item a,#main-nav ul li:hover > a { color: #fff; }
     .widget, article { background: #fff; }
     .entry-title, .entry-title a, .entry-title a:focus, h1, h2, h3, h4, h5, h6, .widget-title  { color: #1b1e1f; }
     a:focus, a:active, a:hover, .tags a:hover, .custom-gallery-title a, .widget-title a, #content ul a:hover,#content ol a:hover, .widget ul li a:hover, .entry-title a:hover, .entry-meta a:hover, #site-generator .copyright a:hover { color: #439f55; }
     #main-nav { background: #57ad68; border-color: #57ad68; }
     #main-nav ul li ul, body { border-color: #439f55; }
     #main-nav a:hover,#main-nav ul li.current-menu-item a,#main-nav ul li.current_page_ancestor a,#main-nav ul li.current-menu-ancestor a,#main-nav ul li.current_page_item a,#main-nav ul li:hover > a, #main-nav li:hover > a,#main-nav ul ul :hover > a,#main-nav a:focus { background: #439f55; }
     #main-nav ul li ul li a:hover,#main-nav ul li ul li:hover > a,#main-nav ul li.current-menu-item ul li a:hover { color: #439f55; }
     .entry-content { color: #1D1D1D; }
     input[type="reset"], input[type="button"], input[type="submit"], .entry-meta-bar .readmore, #controllers a:hover, #controllers a.active, .pagination span, .pagination a:hover span, .wp-pagenavi .current, .wp-pagenavi a:hover { background: #57ad68; border-color: #57ad68 !important; }
     ::selection { background: #57ad68; }
     blockquote { border-color: #439f55; }
     #controllers a:hover, #controllers a.active { color:  #439f55; }
     input[type="reset"]:hover,input[type="button"]:hover,input[type="submit"]:hover,input[type="reset"]:active,input[type="button"]:active,input[type="submit"]:active, .entry-meta-bar .readmore:hover, .entry-meta-bar .readmore:active, ul.default-wp-page li a:hover, ul.default-wp-page li a:active { background: #439f55; border-color: #439f55; }
    </style>
    <style type="text/css" id="custom-background-css">
     body.custom-background { background-image: url("http://balaramadurai.github.io/images/background.png"); background-position: left top; background-size: auto; background-repeat: repeat; background-attachment: scroll; }
    </style>
    <style type="text/css" media="print">#wpadminbar { display:none; }</style>
    <style type="text/css" media="screen">
     * html body { margin-top: 32px !important; }
     @media screen and ( max-width: 782px ) {
	 html { margin-top: 26px !important; }
	 * html body { margin-top: 26px !important; }
     }
    </style>

    
</head>

  <body class="home blog logged-in admin-bar no-customize-support custom-background ">
    <div class="wrapper">
      <header id="branding" >
	<div class="container clearfix">
  <div class="hgroup-wrap clearfix">

    <section class="hgroup-right">
      <div class="social-icons clearfix">
	<ul>
	  
	  <li class="facebook">
	    <a href="https://www.facebook.com/nikimonikado" title="Follow us on Facebook" target="_blank"></a>
	  </li>
	  
	  
	  <li class="twitter">
	      <a href="https://twitter.com/nikimonikado" title="Follow us on Twitter" target="_blank"></a>
	  </li>
	  
	  
	  <li class="email">
	      <a href="mailto:vip_wqj@163.com" title="Email us" target="_blank"></a>
	  </li>
	  
	  
	  <li class="rss">
	    <a href="" title="Subscribe to our feed" target="_blank"></a>
	  </li>
	  
	  
	  <li class="google-plus">
	    <a href="https://www.google.com/+nikimonikado" title="Follow us on Google Plus" target="_blank"></a>
	  </li>
	  
	  
	  
	  <li class="linkedin">
	    <a href="https://www.linkedin.com/in/nikimonikado" title="Follow us on LinkedIn" target="_blank"></a>
	  </li>
	  
	  
	  
	  
	  
	  
	  <li class="youtube">
	    <a href="https://www.youtube.com/nikimonikado" title="Follow us on YouTube" target="_blank"></a>
	  </li>
	  
	  
	  <li class="github">
	    <a href="https://www.github.com/https://github.com/wang961926256" title="Follow us on GitHub" target="_blank"></a>
	  </li>
	  
	</ul>
      </div>
    </section>
    
    
    <hgroup id="site-logo" class="clearfix">
      <h1 id="site-title">
	<a href="http://balaramadurai.github.io/" rel="home">
	  
          <img src="http://balaramadurai.github.io/logo.png"></img>
	  
	  
	  <span class="site-title">wangqj-blog</span>
	  
	</a>
      </h1>
      <h2 id="site-description">一只北漂两年半的电脑爱好者</h2>
    </hgroup>
    
  </div>
</div>


	<nav id="main-nav" class="clearfix">
  <div class="container clearfix">
    <ul class="root">
      
      
      <li class="menu-item menu-item-type-post_type menu-item-object-page ">
	<a href="http://balaramadurai.github.io/program/">编程</a>
	
      </li>
      
      <li class="menu-item menu-item-type-post_type menu-item-object-page ">
	<a href="http://balaramadurai.github.io/reading/">读书</a>
	
      </li>
      
      <li class="menu-item menu-item-type-post_type menu-item-object-page ">
	<a href="http://balaramadurai.github.io/post/linked-post/">Linked post</a>
	
      </li>
      
      <li class="menu-item menu-item-type-post_type menu-item-object-page ">
	<a href="http://balaramadurai.github.io/interview/">面试</a>
	
      </li>
      
    </ul>
  </div>
</nav>

      </header>
      <div id="main" class="container clearfix">
	<div id="container">
	      



    <div id="content">	
	<section id="post" class="post type-post status-publish format-standard has-post-thumbnail hentry">
	    <article>
		<div class="article-inner">
		    <header class="entry-header">
    <a href="http://balaramadurai.github.io/post/hugo-is-for-lovers/">
    <h2 class="entry-title" itemprop="name">
        Java 读取excel文件
    </h2>
    </a>
</header>

		    
    
<div class="entry-meta-bar clearfix">
  <div class="entry-meta">
    
    <span class="byline">
      <span class="author vcard">
        
	<a class="url fn n" href="http://balaramadurai.github.io/author/test1">test1</a>
      </span>
    </span>
    

    
    
    <span class="posted-on">
      <time class="entry-date published" datetime="2015-08-03 13:39:46 &#43;0200 &#43;0200" itemprop="datePublished">03 August, 3030</time>
    </span>
    
    
    
    
    
    <span class="category">
      
      
      <a class="article-category-link" href="http://balaramadurai.github.io/categories/pseudo">pseudo</a>
      
      
    </span>
    
    
    
  </div>
  

		    




<div class="social-icons">
    <ul id="blog">
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

	
	

	<li class="email">
	    <a href="mailto:?subject=Java%20%e8%af%bb%e5%8f%96excel%e6%96%87%e4%bb%b6&body=Hello%20there%2c%20I%20would%20to%20share%20this%20article%20with%20you Java%20%e8%af%bb%e5%8f%96excel%e6%96%87%e4%bb%b6 - http%3a%2f%2fbalaramadurai.github.io%2fpost%2fhugo-is-for-lovers%2f">Email
	    </a>
	</li>
	
	
	
    </ul>
</div>





		</div>
		<div class="entry-content" itemprop="articleBody">
		    <blockquote>
<p><strong>JAVA</strong> 实现批量读取excel文件，将文件中的内容写入到数据库。</p>
</blockquote>
<p>​		最近有个需求是做个数据导入的接口，对方入到进来若干个excel文档，每个文档对应数据库中不同表的内容。数据格式：INFO文件中存放若10张excel文档，文档名称格式为表名-描述（如user-用户表.xls）。</p>
<p>下面将这个过程记录下来，方便之后的查看。</p>
<h4 id="第一步定义一个map用于存放excel文件中所有列的信息">第一步、定义一个Map，用于存放excel文件中所有列的信息。</h4>
<p>以user表为例，存放其中字段的信息，代码如下，仅供参考。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Map</span><span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getExcelFileType</span>() {
	<span style="color:#a6e22e">Map</span><span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">Map</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HashMap</span><span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span>();
	<span style="color:#a6e22e">JSONObject</span> <span style="color:#a6e22e">jsonData</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">JSONObject</span>();
	<span style="color:#a6e22e">jsonData</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;name&#34;</span>, <span style="color:#e6db74">&#34;Str&#34;</span>);             <span style="color:#75715e">//不同类型的数据
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">jsonData</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;date&#34;</span>, <span style="color:#e6db74">&#34;DateTime&#34;</span>);
	<span style="color:#a6e22e">Map</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;user&#34;</span>, <span style="color:#a6e22e">jsonData</span>);
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Map</span>;
}
</code></pre></div><h4 id="第二步-日志设置">第二步、 日志设置</h4>
<p>     数据处理过程中需要记录日志信息。这里使用的是 <strong>java.util.logging</strong>，配置相关的设置，可以将程序中的导入情况输出到日志中，方便查看。代码如下，仅供参考。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">Logger</span> <span style="color:#a6e22e">log</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Logger</span>.<span style="color:#a6e22e">getLogger</span>(<span style="color:#e6db74">&#34;tesglog&#34;</span>);   <span style="color:#75715e">//日志
</span><span style="color:#75715e">//设置日志的级别
</span><span style="color:#75715e"></span><span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">setLevel</span>(<span style="color:#a6e22e">Level</span>.<span style="color:#a6e22e">ALL</span>); 
<span style="color:#75715e">//设置日志存放的路径
</span><span style="color:#75715e"></span><span style="color:#a6e22e">FileHandler</span> <span style="color:#a6e22e">fileHandler</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FileHandler</span>(<span style="color:#e6db74">&#34;D:\import.log&#34;</span>);  
<span style="color:#a6e22e">fileHandler</span>.<span style="color:#a6e22e">setLevel</span>(<span style="color:#a6e22e">Level</span>.<span style="color:#a6e22e">ALL</span>);  
<span style="color:#a6e22e">fileHandler</span>.<span style="color:#a6e22e">setFormatter</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">LogFormatter</span>());  
<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">addHandler</span>(<span style="color:#a6e22e">fileHandler</span>);  
}
</code></pre></div><p>程序执行中会将相应的信息写入到指定的out文件中，程序执行后，可以查看执行的结果信息。</p>
<h4 id="第三步-读取文件夹内容">第三步 读取文件夹内容</h4>
<p><strong>思路</strong>：
1、读取文件夹，遍历其中的excel文件，获取文件名称
2、定义两个变量sqlcolumn 和sqlvalue，分别用于存放拼接的列和值的信息。
3、按行遍历excel文件内容， 第二行开始，对每个单元格进行读取，根据是否有值来进行拼接插入的字符串。
4、运用jdbcOperations来执行拼接的sql语句，实现数据的入库。
程序实现的代码如下所示，仅供参考。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">//读取文件夹的信息
</span><span style="color:#75715e"></span><span style="color:#a6e22e">File</span> <span style="color:#a6e22e">fileINFO</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">File</span>(<span style="color:#e6db74">&#34;D:\INFO&#34;</span>);
<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">fileINFO</span>.<span style="color:#a6e22e">isDirectory</span>()){
	String[] <span style="color:#a6e22e">fileINFOlist</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fileINFO</span>.<span style="color:#a6e22e">list</span>();
	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; <span style="color:#a6e22e">i</span><span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">fileINFOlist</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> ){
	<span style="color:#a6e22e">TableName</span><span style="color:#f92672">=</span><span style="color:#a6e22e">fileINFOlist</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">fileINFOlist</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;-&#39;</span>));  		<span style="color:#75715e">//截取获取表名
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">filePath</span><span style="color:#f92672">=</span><span style="color:#a6e22e">fileINFO</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;\\&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">fileINFOlist</span>[<span style="color:#a6e22e">i</span>];      <span style="color:#75715e">//拼接excel文件的路径
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//以流 逐个读取文件夹中的文件
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">stream</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FileInputStream</span>(<span style="color:#a6e22e">file</span>);
	<span style="color:#75715e">//读取工作簿
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Workbook</span> <span style="color:#a6e22e">book</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Workbook</span>(<span style="color:#a6e22e">stream</span>);
	<span style="color:#a6e22e">WorksheetCollection</span> <span style="color:#a6e22e">sheets</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">book</span>.<span style="color:#a6e22e">getWorksheets</span>();  <span style="color:#75715e">//获取sheet信息
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// 获取表格中的所有单元格
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Cells</span> <span style="color:#a6e22e">cells</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sheets</span>.<span style="color:#a6e22e">get</span>(<span style="color:#ae81ff">0</span>).<span style="color:#a6e22e">getCells</span>();       <span style="color:#75715e">//从第一行开始取单元格
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">maxColumnCount</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cells</span>.<span style="color:#a6e22e">getMaxColumn</span>()<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>; <span style="color:#75715e">//获取最大列
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">rowCount</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cells</span>.<span style="color:#a6e22e">getLastDataRow</span>(<span style="color:#ae81ff">1</span>);      <span style="color:#75715e">//获取最近数据行
</span><span style="color:#75715e"></span>	String <span style="color:#a6e22e">cellValue</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String();               <span style="color:#75715e">//单元格的信息串
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">StringBuffer</span> <span style="color:#a6e22e">errorReport</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">StringBuffer</span>();   <span style="color:#75715e">// 检验错误信息
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//获取excel文件中的所有列信息   --自定义的方法
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Map</span><span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">ExcelFile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">getExcelFileType</span>();      
	<span style="color:#a6e22e">JSONObject</span>  <span style="color:#a6e22e">jsonObject</span> <span style="color:#f92672">=</span>(<span style="color:#a6e22e">JSONObject</span>) <span style="color:#a6e22e">ExcelFile</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">TableName</span>);
	<span style="color:#75715e">// 判断表格列数是否符合要求
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">mm</span><span style="color:#f92672">=</span><span style="color:#a6e22e">jsonObject</span>.<span style="color:#a6e22e">size</span>();
	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">maxColumnCount</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">jsonObject</span>.<span style="color:#a6e22e">size</span>()) {
		<span style="color:#a6e22e">map</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;success&#34;</span>, <span style="color:#e6db74">&#34;false&#34;</span>);
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;列的数量不正确！&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">fileINFOlist</span>[<span style="color:#a6e22e">i</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;信息只能&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">jsonObject</span>.<span style="color:#a6e22e">size</span>()<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;列值！&#34;</span>);
		<span style="color:#66d9ef">return</span>;
		}
		
 	<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">k</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; <span style="color:#75715e">//从第2行开始取值
</span><span style="color:#75715e"></span> 	<span style="color:#66d9ef">for</span> (; <span style="color:#a6e22e">k</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">rowCount</span>; <span style="color:#a6e22e">k</span><span style="color:#f92672">++</span>) {     <span style="color:#75715e">//从第二行开始读数据
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
		<span style="color:#a6e22e">Iterator</span><span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">male_Iterator</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">jsonObject</span>.<span style="color:#a6e22e">keys</span>();
		<span style="color:#75715e">//拼接数据库插入sql insert
</span><span style="color:#75715e"></span>		String  <span style="color:#a6e22e">sqlcolumn</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; INSERT INTO &#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">TableName</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34; ( &#34;</span>;
		<span style="color:#75715e">//拼接数据库插入sql value值
</span><span style="color:#75715e"></span>		String  <span style="color:#a6e22e">sqlvalue</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; ) VALUES( &#34;</span>;
		<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">tableNameID</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
		<span style="color:#66d9ef">while</span>(<span style="color:#a6e22e">male_Iterator</span>.<span style="color:#a6e22e">hasNext</span>()){   <span style="color:#75715e">//迭代器遍历
</span><span style="color:#75715e"></span>			<span style="color:#75715e">//获得单元格的value值
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">Cell</span> <span style="color:#a6e22e">cell</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cells</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">k</span>, <span style="color:#a6e22e">j</span>);<span style="color:#75715e">//单元格
</span><span style="color:#75715e"></span>			<span style="color:#75715e">// 单元格内数据
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">cellValue</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">null</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">cell</span>.<span style="color:#a6e22e">getValue</span>() <span style="color:#f92672">||</span><span style="color:#a6e22e">cell</span>.<span style="color:#a6e22e">getValue</span>().<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">?</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cell</span>.<span style="color:#a6e22e">getStringValue</span>().<span style="color:#a6e22e">trim</span>());
			<span style="color:#75715e">// 获得key 
</span><span style="color:#75715e"></span>			String <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">male_Iterator</span>.<span style="color:#a6e22e">next</span>();
			<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">cellValue</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>){
				<span style="color:#a6e22e">sqlcolumn</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">key</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;,&#34;</span>;    <span style="color:#75715e">//拼接列值，如： insert into user
</span><span style="color:#75715e"></span>				String <span style="color:#a6e22e">dataType</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">jsonObject</span>.<span style="color:#a6e22e">getString</span>(<span style="color:#a6e22e">key</span>);
				<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">dataType</span>.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;Str&#34;</span>)){  
					<span style="color:#a6e22e">sqlvalue</span><span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&#39;&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">cellValue</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;,&#34;</span>;
				}<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">dataType</span>.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;DateTime&#34;</span>)){   <span style="color:#75715e">//排序字段
</span><span style="color:#75715e"></span>					<span style="color:#a6e22e">sqlvalue</span><span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34; DATE_FORMAT(&#39;&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">cellValue</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;,&#39;%Y-%m-%d %H:%i:%s&#39;),&#34;</span>;
				}<span style="color:#66d9ef">else</span> {
					<span style="color:#a6e22e">sqlvalue</span><span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&#39;&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">cellValue</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;,&#34;</span>;
				}				
		     }
	    }
	    <span style="color:#75715e">//读取完整行数据 拼接一条insert插入语句执行
</span><span style="color:#75715e"></span>	    <span style="color:#a6e22e">sqlcolumn</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sqlcolumn</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">sqlcolumn</span>.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);  <span style="color:#75715e">//去除逗号
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">sqlvalue</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sqlvalue</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">sqlvalue</span>.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);  <span style="color:#75715e">//去除逗号
</span><span style="color:#75715e"></span>		String <span style="color:#a6e22e">insertsql</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sqlcolumn</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">sqlvalue</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;) &#34;</span>;
		<span style="color:#75715e">//这里运用jdbcOperations来实现数据库的操作
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">try</span> {
				<span style="color:#a6e22e">jdbcOperations</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">insertsql</span>);
			} <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Exception</span> <span style="color:#a6e22e">e</span>) {
				<span style="color:#a6e22e">map</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;success&#34;</span>, <span style="color:#e6db74">&#34;false&#34;</span>);
				<span style="color:#a6e22e">map</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;msg&#34;</span>, <span style="color:#a6e22e">fileINFOlist</span>[<span style="color:#a6e22e">i</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; 文件中 第&#34;</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">k</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;行数据插入失败,请核查该条数据。;&#34;</span>);
				<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">info</span>(<span style="color:#a6e22e">fileINFOlist</span>[<span style="color:#a6e22e">i</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;文件中 第&#34;</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">k</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;行数据插入失败,请核查该条数据。&#34;</span>);
				<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;错误日志信息为：&#34;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">getMessage</span>());
		}
	}
}
</code></pre></div><p>总结：读取excel文件的内容功能较为常见，这里采用的主要是提前将文件中的列写入到map中，根据类型来进行取值，拼接sql来实现数据的入库。</p>
<h4 id="博客参考">博客参考</h4>
<p>【1】https://blog.csdn.net/gxx_csdn/article/details/79085713</p>

		    	
		</div>
		
		<div class="tags">
		    
		    <a href="http://balaramadurai.github.io/tags/hugo" rel="tag">hugo</a>&middot;
		    
		</div>
		
		
<ul class="default-wp-page clearfix">
  
  <li class="previous">
    <a href="http://balaramadurai.github.io/post/creating-a-new-theme/" rel="prev">
      <span class="meta-nav">
	←
      </span>
      Creating a new theme
    </a>
  </li>
  
  
  
  <li class="next">
    <a href="http://balaramadurai.github.io/post/go-is-for-lovers/" rel="next">
      Go is for lovers
      <span class="meta-nav">
	→
      </span>
    </a>
  </li>
  
</ul>


	    </article>
	    
	    
	</section>
	
    </div>




      </div>   
    </div>
    <footer id="footerarea" class="clearfix">
  <div class="widget-wrap">
    <div class="container">
      <div class="widget-area clearfix">
      </div>
    </div>
  </div>
  
  <div id="site-generator">
    <div class="container">
      <div class="copyright">&copy; 2020
	Copyright Powered by <a href="http://gohugo.io">Hugo</a>. Original theme by <a href="http://colorlib.com/wp/travelify/">Colorlib</a> adapted for Hugo by <a href="http://balaramadurai.net">Dr. Bala Ramadurai</a>.
      </div>
      <div class="footer-right"></div><div style="clear:both;">
      </div>
    </div>
  </div>
  <div class="back-to-top">
    <a href="#branding"></a>
  </div>
</footer>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script type='text/javascript' src="http://balaramadurai.github.io/js/jquery.js"></script>
<script type='text/javascript' src="http://balaramadurai.github.io/js/jquery-migrate.min.js"></script>
<script type='text/javascript' src="http://balaramadurai.github.io/js/functions.min.js"></script>

<script type='text/javascript' src="http://balaramadurai.github.io/js/jquery.cycle.all.min.js"></script>
<script type='text/javascript'>
  
 var travelify_slider_value = {"transition_effect":"fade","transition_delay":"4000","transition_duration":"1000"};
  
</script>
<script type='text/javascript' src="http://balaramadurai.github.io/js/slider-settings.min.js"></script>
<script type='text/javascript' src="http://balaramadurai.github.io/js/wp-embed.min.js"></script>
<link rel='stylesheet' id='font-awesome-css'  href="http://balaramadurai.github.io/css/font-awesome.min.css" type='text/css' media='all' />


<script type="text/javascript">
 (function() {
     var request, b = document.body, c = 'className', cs = 'customize-support', rcs = new RegExp('(^|\\s+)(no-)?'+cs+'(\\s+|$)');
     
     request = true;
     
     b[c] = b[c].replace( rcs, ' ' );
     
     b[c] += ( window.postMessage && request ? ' ' : ' no-' ) + cs;
 }());
</script>

<link rel="apple-touch-icon" href="http://balaramadurai.github.io/apple-touch-icon.png" />
<link rel="stylesheet" href="http://balaramadurai.github.io/fancybox/jquery.fancybox.css">


<script src="http://balaramadurai.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script src="http://balaramadurai.github.io/js/script.js"></script>






  </body>
</html>
